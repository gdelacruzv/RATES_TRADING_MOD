 CD C:\Users\Gilberto\Documents\Econometrics
Workfile Cap_Stone.WF1 M 1953:4 2024:6 
READ(B7,S=Monthly) Cap_Stone.XLS UST_10YR BREAKR_10YR	WORKH	FFR UST_3M UST_1YR UST_5YR TIPS_5YR TIPS_10YR TAY FWD_5YR_INF UNRATE TCU INDPRO PCEXFE CPIXFE EXPINF_3YR EXPINF_5YR EXPINF_2YR CPI EXPINF_10YR Real_10yr EPU BAL PPI SPREAD AA_YIELD BA_YIELD


IF @FILEEXIST("CAP1.EDB")=1 THEN
	DBDELETE     CAP1
ENDIF

DBCREATE CAP1

STORE(d=CAP1) UST_10YR BREAKR_10YR WORKH FFR UST_3M UST_1YR UST_5YR TIPS_5YR TIPS_10YR TAY FWD_5YR_INF UNRATE TCU INDPRO PCEXFE CPIXFE EXPINF_3YR EXPINF_5YR EXPINF_2YR CPI EXPINF_10YR REAL_10yr EPU BAL PPI SPREAD AA_YIELD BA_YIELD

CLOSE Cap_1M.WF1

WORKFILE CAP_1Q Q 1981:3 2024:2
FETCH(d=CAP1, C=A) UST_10YR BREAKR_10YR WORKH FFR UST_3M UST_1YR UST_5YR TIPS_5YR TIPS_10YR TAY FWD_5YR_INF UNRATE TCU INDPRO PCEXFE CPIXFE EXPINF_3YR EXPINF_5YR EXPINF_2YR CPI EXPINF_10YR REAL_10yr EPU BAL PPI SPREAD AA_YIELD  BA_YIELD
			   



READ(B7,S=QUARTERLY) CAP_Stone.XLS INFFSP_1YR INFFSP_10YR WORK_POP AA_YIELD_Q LABOR_PROD FISCAL SHOCK F_CONT CPI_Q PCE_Q OECD_RR LABOR_P PPI_FIN PPI_MAT PPI_CRU RP_GDP R_GDP


'----------------------'
'---DATA-DERIVIATION---'
'----------------------'
SERIES UST_3M$ =UST_3M-@PCY(CPI)
SERIES UST_1YR$ =UST_1YR-@PCY(CPI)
SERIES UST_5YR$ =UST_5YR-@PCY(CPI)
SERIES UST_10YR$ =UST_10YR-@PCY(CPI_Q)
SERIES FISCAL$ = FISCAL-@PCY(CPI)
SERIES FISCAL$_MAV = @MAV(FISCAL$,10)
SERIES BAL$ = BAL-@PCY(CPI)
SERIES BAL$ = @MAV(BAL$,10)
SERIES AA_YIELD$ =AA_YIELD-@PCY(CPI)
SERIES TIPS_5YR_SPREAD= TIPS_5YR - UST_5YR
SERIES TIPS_10YR_SPREAD= TIPS_10YR - UST_10YR
SERIES GAP_10YR = REAL_10YR + EXPINF_10YR
SERIES REAL_10yr_PCA = @PCA(REAL_10yr)
SERIES EXPINF_10YR_PCA = @PCA(EXPINF_10YR)
SERIES EXPINF_1YR = @MAV(EXPINF_1YR,10)
SERIES LABOR_PROD = @MAV(LABOR_PROD,10)  
SERIES WORKH = @MAV(WORKH,10)  
SERIES WORK_POP = @MAV(WORK_POP,10)
SERIES CPI_Log = @LOG(CPI/CPI(-1))
SERIES UST_3M_10YR_SPREAD$ = UST_10YR$-UST_3M$
SERIES UST_3M_10YR_SPREAD = UST_10YR-UST_3M
SERIES DF_SPREAD = BA_YIELD-AA_YIELD

'-----------------------'
'---Unit-Root-Testing---'
'-----------------------'
SMPL 1982:1 2022:2
GRAPH G1 GAP_10YR @PCA(GAP_10YR) 
GRAPH G2 EXPINF_10YR @PCA(EXPINF_10YR)
GRAPH G3 REAL_10yr @PCA(REAL_10yr)
GRAPH G4 UST_10YR @PCA(UST_10YR)
GRAPH G5 REAL_10yr @PCY(REAL_10yr)
GROUP UNIT_ROOT
	FREEZE(EXPINF_10YR_ADF) EXPINF_10YR.UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18) 
		SERIES EXPINF_10YR_ADF_RES= RESID
	FREEZE(EXPINF_10YR_DFGLS) EXPINF_10YR.UROOT(DFGLS,C,DIF=0,LAGMETHOD=AIC,MAXLAG=18)
		SERIES EXPINF_10YR_ADF_RES= RESID
	FREEZE(EXPINF_10YR_KPSS) EXPINF_10YR.UROOT(KPSS,C,HAC=QS,BAND=12)
		SERIES EXPINF_10YR_ADF_RES= RESID

	FREEZE(EXPINF_10YR_ADF_D) @PCA(EXPINF_10YR).UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18) 
		SERIES EXPINF_10YR_ADF_D_RES= RESID
	FREEZE(EXPINF_10YR_DFGLS_D) @PCA(EXPINF_10YR).UROOT(DFGLS,C,DIF=0,LAGMETHOD=AIC,MAXLAG=18)
		SERIES EXPINF_10YR_ADF_D_RES= RESID
	FREEZE(EXPINF_10YR_KPSS_D) @PCA(EXPINF_10YR).UROOT(KPSS,C,HAC=QS,BAND=12)
		SERIES EXPINF_10YR_ADF_D_RES= RESID


FREEZE(REAL_10yr_ADF) REAL_10yr.UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18)
	SERIES REAL_10_ADF_RES= RESID
FREEZE(REAL_10YR_DFGLS) REAL_10YR.UROOT(DFGLS,C,DIF=0,LAGMETHOD=AIC,MAXLAG=18)
	SERIES EXPINF_10YR_ADF_RES= RESID
FREEZE(REAL_10YR_KPSS) REAL_10YR.UROOT(KPSS,C,HAC=QS,BAND=12)
	SERIES EXPINF_10YR_ADF_RES= RESID

FREEZE(REAL_10yr_ADF_D) @PCA(REAL_10yr).UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18)
	SERIES REAL_10_ADF_RES= RESID
FREEZE(REAL_10YR_DFGLS_D) @PCA(REAL_10YR).UROOT(DFGLS,C,DIF=0,LAGMETHOD=AIC,MAXLAG=18)
	SERIES EXPINF_10YR_ADF_RES= RESID
FREEZE(REAL_10YR_KPSS_D) @PCA(REAL_10YR).UROOT(KPSS,C,HAC=QS,BAND=12)
	SERIES EXPINF_10YR_ADF_RES= RESID

'---------------------------------------------------'
'---Inertial Models in support of structural model--'
'---------------------------------------------------'
SMPL 1981:3 2022:2
 EQUATION E_EXPINF_10YR.LS EXPINF_10YR C AR(1) MA(2) MA(4)    

 EQUATION E_REAL_10YR.LS REAL_10YR C AR(1) MA(4) 

 EQUATION E_BREAKR_10YR.LS BREAKR_10YR C AR(1) MA(1)  

 EQUATION E_TIPS_10YR_SPREAD.LS TIPS_10YR_SPREAD C AR(1) MA(1)                    

 EQUATION E_TCU.LS TCU C AR(1) AR(2)     

 EQUATION E_INDPRO.LS INDPRO C AR(1) AR(2) 
                      
 EQUATION E_EXPINF_10YR.LS EXPINF_10YR C AR(1) MA(2) MA(4)
         
 EQUATION E_INFFSP_10YR.LS INFFSP_10YR C AR(1) MA(1) 

 EQUATION E_WORKH.LS @PCA(WORKH) C AR(1) MA(10) 
             
 EQUATION E_WORK_POP.LS @PCA(WORK_POP) C AR(1) AR(2) MA(2) 
             
 EQUATION E_UST_10YR$.LS UST_10YR$ C AR(1) MA(1) MA(2)
 
 EQUATION E_AA_YIELD$.LS AA_YIELD$ C AR(1) MA(1)                     

 EQUATION E_LABOR_PROD.LS @PCA(LABOR_PROD) C AR(1) AR(3) 

 EQUATION E_FISCAL$.LS @PCA(FISCAL$) C AR(1) AR(3) MA(2) 
          
 EQUATION E_BAL$.LS @PCA(BAL$) C AR(1) MA(1) 
      
 EQUATION E_EPU.LS @PCA(EPU) C AR(1) MA(1) 
             
 EQUATION E_PPI.LS @PCA(EPU) C AR(1) MA(1) 
             
 EQUATION E_CPI.LS @PCA(CPI) C AR(1) MA(1) 

 EQUATION E_CPI_Q.LS @PCA(CPI_Q) C AR(1) MA(1) 
          
 EQUATION E_F_CONT.LS @PCA(f_CONT) C AR(1) MA(1) 
 EQUATION E_LABOR_P.LS @PCA(LABOR_P) C AR(1) MA(1) 
 EQUATION E_SPREAD.LS SPREAD C AR(1) MA(1) 
 EQUATION E_UST_3M_10YR_SPREAD.LS UST_3M_10YR_SPREAD C AR(1) MA(1)
 EQUATION E_RP_GDP.LS RP_GDP C AR(1) MA(1)
 EQUATION E_R_GDP.LS R_GDP C AR(1) MA(1)
 EQUATION E_FFR.LS R_GDP C AR(1) MA(1)
 EQUATION E_UST_3M.LS UST_3M C AR(1) MA(1)
 EQUATION E_DF_SPREAD.LS DF_SPREAD C AR(1) MA(1)
 EQUATION E_BA_YIELD.LS BA_YIELD C AR(1) MA(1)
'--------------------'
'---ARIMA-FORECAST---'
'--------------------'

SMPL 2022:2 2024:2
E_BREAKR_10YR.FORECAST BREAKR_10YR_2020
E_TIPS_10YR_SPREAD.FORECAST TIPS_10YR_SPREAD_2020
E_TCU.FORECAST TCU_2020
E_INDPRO.FORECAST INDPRO_2020
E_EXPINF_10YR.FORECAST EXPINF_10YR_2020
E_INFFSP_10YR.FORECAST INFFSP_10YR_2020
E_WORKH.FORECAST WORKH_2020
E_WORK_POP.FORECAST WORK_POP_2020
E_Real_10yr.FORECAST Real_10yr_2020
E_UST_10YR$.FORECAST UST_10YR$_2020
E_LABOR_PROD.FORECAST LABOR_PROD_2020
E_AA_YIELD$.FORECAST AA_YIELD$_2020
E_FISCAL$.FORECAST FISCAL$_2020
E_BAL$.FORECAST BAL$_2020
E_EPU.FORECAST EPU_2020
E_CPI_Q.FORECAST CPI_Q_2020
E_PPI.FORECAST PPI_2020
E_LABOR_P.FORECAST LABOR_P_2020
E_CPI.FORECAST CPI_2020
E_SPREAD.FORECAST SPREAD_2020
E_UST_3M_10YR_SPREAD.FORECAST UST_3M_10YR_SPREAD_2020
E_RP_GDP.FORECAST RP_GDP_2020
E_R_GDP.FORECAST R_GDP_2020
E_FFR.FORECAST FFR_2020
E_UST_3M.FORECAST UST_3M_2020
E_DF_SPREAD.FORECAST DF_SPREAD_2020
E_BA_YIELD.FORECAST BA_YIELD_2020
'--------------------------------'
'--REVERT TO STANDARD MNEMONICS--'
'---------------------------------'

SMPL 2022:2 2024:2
	SERIES BREAKR_10YR = BREAKR_10YR_2020
	SERIES TIPS_10YR_SPREAD = TIPS_10YR_SPREAD_2020
	SERIES TCU = TCU_2020
	SERIES INDPRO = INDPRO_2020
	SERIES EXPINF_10YR = EXPINF_10YR_2020
	SERIES INFFSP_10YR = INFFSP_10YR_2020
	SERIES WORKH = WORKH_2020
	SERIES WORK_POP = WORK_POP_2020
	SERIES Real_10yr = Real_10yr_2020
	SERIES UST_10YR$ = UST_10YR$_2020
	SERIES AA_YIELD$ = AA_YIELD$_2020
	SERIES LABOR_PROD = LABOR_PROD_2020
	SERIES FISCAL$ = FISCAL$_2020
	SERIES BAL$ = BAL$_2020
	SERIES EPU = EPU_2020
	SERIES CPI_Q = CPI_Q_2020
	SERIES PPI = PPI_2020
	SERIES LABOR_P = LABOR_P_2020
	SERIES CPI = CPI_2020
	SERIES SPREAD = SPREAD_2020
	SERIES UST_3M_10YR_SPREAD = UST_3M_10YR_SPREAD_2020
	SERIES R_GDP = R_GDP_2020
	SERIES RP_GDP = RP_GDP_2020
	SERIES FFR = FFR_2020
	SERIES UST_3M =UST_3M_2020
	SERIES DF_SPREAD =DF_SPREAD_2020	
	SERIES BA_YIELD =BA_YIELD_2020

SMPL 1997:1 2022:2
     graph Ten_year_summary UST_10YR EXPINF_10YR REAL_10YR GAP_10YR
SMPL 1982:2 2022:1
	graph Real_10year @PC(Real_10yr) Real_10yr
SMPL 1982:2 2022:1
	graph inflation2 @pc(EXPINF_10YR) EXPINF_10YR
SMPL 1982:2 2024:2
	SERIES FFR$= FFR-@PCA(CPI)
	

'-------------------------------------------------------------'
'--------10YR EXPECTED INFLATION STRUCTURAL MODEL-------------'
'-------------------------------------------------------------'
SMPL 2003:1 2024:2
	EQUATION  STRUCT_10YR_INF.COINTREG(METHOD=fmols,kern=QUADSPEC,bw=ANDREWS) INFFSP_10YR C BREAKR_10YR @PCA(BAL$(-1)) FFR$(-1)  @PCA(CPI_Q(-1))
	SERIES STRUCT_10YR_INF_RESIDS=RESID
	FREEZE(STRUCT_10YR_INF_RESIDS_ADF) STRUCT_10YR_INF_RESIDS.UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18) 	
	
SMPL 1991:3 2024:2
	EQUATION  STRUCT_10YRIN_OLSz.LS(N) EXPINF_10YR C INFFSP_10YR(-1) SPREAD  @PCA(CPI_Q(-3)) FFR 
		SERIES  STRUCT_10YRIN_OLSz_RESIDS=RESID
		SERIES  EXPINF_10YR_RF =STRUCT_10YRIN_OLSz_RESIDS+EXPINF_10YR
		FREEZE( STRUCT_10YRIN_OLSz_RESIDS_ADF)  STRUCT_10YRIN_OLSz_RESIDS.UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18)
		SMPL 1997:2 2022:2
 		

'-------------------------------------------------------------'
'--------------10YR REAL RATE STRUCTURAL MODEL----------------'
'-------------------------------------------------------------'
SMPL 1991:3 2024:2
	EQUATION  STRUCT_10YRR.COINTREG(METHOD=fmols,kern=QUADSPEC,bw=ANDREWS) Real_10YR C  AA_YIELD @pca(WORKH) SHOCK @pca(EPU) FFR$ @PCY(BAL$) FISCAL$ @pca(WORK_POP) @pca(UNRATE) 
	EQUATION  STRUCT_10YRR_B.COINTREG(METHOD=fmols,kern=QUADSPEC,bw=ANDREWS) Real_10YR C AA_YIELD @PCY(BAL$) FFR$
	EQUATION  AAA_Real_coint.COINTREG(METHOD=fmols,kern=QUADSPEC,bw=ANDREWS) AA_YIELD$ C FFR$ @pcY(LABOR_P(-2)) Shock 
	
	

SMPL 1991:3 2024:2
  	EQUATION  STRUCT_10YRR_OLSCZ.LS(N) Real_10YR C AA_YIELD RP_GDP 
		  SERIES  STRUCT_10YRR_OLSCZ_RESIDS=RESID
		  FREEZE( STRUCT_10YRR_OLSCZ_RESIDS_ADF)  STRUCT_10YRR_OLSCZ_RESIDS.UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18)

SMPL 1991:3 2024:2
	EQUATION  STRUCT_AA_YIELD_OLS1.LS(N) AA_YIELD$ C FFR$ @pcY(LABOR_P(-2)) 
	EQUATION  STRUCT_AA_YIELD_OLS3.LS(N) AA_YIELD$ C FFR$ @pcY(LABOR_P(-2)) @PC(ffr) DF_SPREAD
	EQUATION  STRUCT_AA_YIELD_OLS2.LS(N) AA_YIELD$ C FFR$ @pcY(LABOR_P(-2)) @PC(ffr) UST_3M
	EQUATION  STRUCT_AA_YIELD_OLS4.LS(N) AA_YIELD$ C FFR$ @pcY(LABOR_P(-2))  r_gdp SHOCK BA_YIELD UST_3M
	EQUATION  STRUCT_AA_YIELD_OLS.LS(N) AA_YIELD$ C FFR$ @pcY(LABOR_P(-2))  r_gdp SHOCK BA_YIELD
 		SERIES  STRUCT_AA_YIELD_OLS_RESIDS=RESID
		FREEZE( STRUCT_AA_YIELD_OLS_RESIDS_ADF)  STRUCT_AA_YIELD_OLS_RESIDS.UROOT(ADF,C,LAGMETHOD=AIC,MAXLAG=18)
'-------------------------------------------------------------'
'-----------------STRUCTURAL MODEL OBJECT------------------ ---'
'-------------------------------------------------------------'
SMPL 2001:1 2024:2
MODEL Nominal_10YR_MOD
	Nominal_10YR_MOD.MERGE STRUCT_AA_YIELD_OLS STRUCT_10YRR_OLSCZ STRUCT_10YRIN_OLSz
	Nominal_10YR_MOD.APPEND AA_YIELD = AA_YIELD$ + @PCY(CPI)
	Nominal_10YR_MOD.APPEND GAP_10YR = REAL_10YR + EXPINF_10YR
	Nominal_10YR_MOD.APPEND ASSIGN @ALL _MOD1
	Nominal_10YR_MOD.SOLVE


Nominal_10YR_MOD.APPEND ASSIGN @ALL _SH
SMPL 2001:1 2022:2
	Nominal_10YR_MOD.SOLVE	

Nominal_10YR_MOD.APPEND ASSIGN @ALL _SF
SMPL 2022:3 2024:2
	Nominal_10YR_MOD.SOLVE
	
SMPL 2022:2 2024:2
	SERIES GAP_10YR_SF = GAP_10YR_SF

SMPL 2001:1 2024:2
	Graph GAP_MODEL GAP_10YR_SF UST_10YR GAP_10YR GAP_10YR_SH



STOP

	
